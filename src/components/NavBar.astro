---
import { Icon } from 'astro-icon/components';

// Simple fixed top navigation bar for the site
const links = [
  { label: 'Rejoindre', href: '/nous-rejoindre.html', icon: 'users-four' },
  { label: 'Sites', href: '/global/sites.html', icon: 'globe' },
  { label: 'Visuels', href: '/local/_visuels.html', icon: 'paint-brush' },
  { label: 'DolÃ©ances', href: '/local/doleances.html', icon: 'note-pencil' },
];

const normalize = (p) => p.replace(/\/+$/, '').replace(/\.html?$/, '') || '/';
const urlLastPart = '/' + (Astro.url.pathname.replace(/\/+$/, '').split('/').filter(Boolean).pop() || '');
console.log('last part of the url', urlLastPart);
---

<nav class="bg-neutral-dark border-b border-neutral-medium">
  <div class="container mx-auto px-2 md:px-4 md:py-2 flex items-center justify-between gap-2">
    <a href="/" class="flex items-center gap-2">
      <img src="/global/img/logo-inbt.svg" alt="Indignons-nous logo" class="h-14 w-auto" />
      <span class="sr-only">Accueil</span>
    </a>

    <div class="flex items-center gap-2 overflow-x-auto">
      {links.map(({ label, href, icon }) => (
        <a
          href={href}
          class=`flex items-center gap-1 shrink-0 p-2 rounded md:min-w-24 ${normalize(href) === urlLastPart ? 'bg-primary-yellow pointer-events-none' : 'bg-neutral-50'} text-neutral-dark text-sm font-medium hover:bg-primary-yellow-light border border-neutral-medium focus:outline-none focus:ring-2 focus:ring-primary-yellow transition`
          aria-label={label}
          aria-current={normalize(href) === urlLastPart ? 'page' : 'false'}
          pointer-events={normalize(href) === urlLastPart ? 'none' : 'auto'}
        >
          <Icon name={icon} class="w-4 h-4" aria-hidden="true" />
          <span class="leading-none">{label}</span>
        </a>
      ))}
    </div>
  </div>
</nav>